# defcon-2025-domain-fronting
Defcon 2025 Malware Village Domain Fronting Talk

Building on the great work of karthika subramani

@misc{paper_link, title = {Discovering and Measuring CDNs Prone to Domain Fronting}, year = {2024}, howpublished = {\url{https://doi.org/10.1145/3589334.3645656}} }

https://github.com/karthikaS03/DomainFrontingDiscovery

## 1. CDN List (Manual Process)

To rank and test a collection of CDNs we need a list of CDNs! 

This was gathered through some Googling and manual research
and then [PeeringDB](https://www.peeringdb.com/net/906) and [HackerTarget](https://hackertarget.com/as-ip-lookup/) were used
to associate each CDN with their ASN number. 

We store this list in `cdn_asn.csv`

Data Collection Date: 2025-07-06

## 2. ASN to IP Map

We then use the `cdn-asn-ip-map` Go program to covert all the CDN ASN numbers to a collection of IP addresses
which we dump as JSON to be used in a lookup table. 
This uses the free https://iptoasn.com tab separated database to perform the lookup.

```shell
go run cmd/cdn-asn-ip-map/main.go
```

## 3. Prepare domain list

We now need to visit / scape a large number of sites to find which CDNs are used to host them. In order todo that we need a large list
of websites to visit.
- https://tranco-list.eu/ - For the top 1 million domains

## 4. Scrape domains and analyze CDN usage

The `scape` tool processes a list of domains, uses DNS data and the IP mapping JSON file to determine which CDN the domain is connected too

### Disadvantages

DNS based looksups, you get different responses depending on where you query and how. On the command line I was getting samsum servers and in the browser I was getting Achamie

### Notes

Most of the code in this repo was generated by Jetbrains Junie AI Agent, it should be taken with a pinch of salt.
